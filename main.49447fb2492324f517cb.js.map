{"version":3,"file":"main.49447fb2492324f517cb.js","mappings":"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","sources":["webpack://mccabe-thiele-method-online/./src/resources/js/eq_line.js","webpack://mccabe-thiele-method-online/./src/resources/js/ui.js","webpack://mccabe-thiele-method-online/./src/resources/js/mccabe-thiele.js","webpack://mccabe-thiele-method-online/./src/resources/js/main.js"],"sourcesContent":["/**\n * @typedef {{x: number, y: number}} VLEPoint\n */\n\n// VLE 데이터는 모듈 내부 변수에 저장되며, 외부에서 주입 가능\n/** @type {VLEPoint[]} */\nlet VLE_DATA = [];\n\n// [TODO] Methanol-Water 기본 데이터 (초기값으로 사용)\nexport const METHANOL_VLE_DATA = [\n  { x: 0.0, y: 0.0 },\n  { x: 0.012, y: 0.068 },\n  { x: 0.02, y: 0.121 },\n  { x: 0.026, y: 0.159 },\n  { x: 0.033, y: 0.188 },\n  { x: 0.036, y: 0.215 },\n  { x: 0.053, y: 0.275 },\n  { x: 0.076, y: 0.366 },\n  { x: 0.1, y: 0.438 },\n  { x: 0.12, y: 0.485 },\n  { x: 0.14, y: 0.522 },\n  { x: 0.15, y: 0.541 },\n  { x: 0.2, y: 0.605 },\n  { x: 0.3, y: 0.686 },\n  { x: 0.4, y: 0.739 },\n  { x: 0.5, y: 0.779 },\n  { x: 0.6, y: 0.825 },\n  { x: 0.7, y: 0.87 },\n  { x: 0.8, y: 0.915 },\n  { x: 0.9, y: 0.958 },\n  { x: 0.95, y: 0.979 },\n  { x: 1.0, y: 1.0 },\n];\n\n// 모듈 로드 시 기본 데이터로 초기화\ninitializeVLEData(METHANOL_VLE_DATA);\n\n/**\n * 외부에서 VLE 데이터를 주입하여 모듈을 초기화합니다.\n * @param {VLEPoint[]} newVLEData - 정렬된 VLE 포인트 배열\n */\nexport function initializeVLEData(newVLEData) {\n  if (!Array.isArray(newVLEData) || newVLEData.length < 2) {\n    console.error(\n      'VLE Data initialization failed: Data must be an array with at least 2 points.'\n    );\n    VLE_DATA = METHANOL_VLE_DATA; // 오류 시 기본값 유지\n    return;\n  }\n  // [핵심] 외부 데이터를 내부 변수에 저장\n  VLE_DATA = newVLEData;\n  console.log(`VLE Data initialized with ${VLE_DATA.length} points.`);\n}\n\n/**\n * 액상 조성(x_in)에 대한 이상 평형 기상 조성(y)을 계산합니다.\n * 선형 보간(Linear Interpolation)을 사용합니다.\n * @param {number} x_in - 액상 몰분율\n * @returns {number} - 기상 몰분율 (y)\n * @param {number} alpha\n */\nexport function getIdealEquilibriumY(x_in, alpha) {\n  if (x_in <= 0) {\n    return 0;\n  }\n  if (x_in >= 1) {\n    return 1;\n  }\n  if (alpha) {\n    return (x_in * alpha) / (1 + (alpha - 1) * x_in);\n  }\n\n  // [핵심] 내부 변수 VLE_DATA 사용\n  let p1 = VLE_DATA[0];\n  let p2 = VLE_DATA[1];\n\n  for (let i = 1; i < VLE_DATA.length; i++) {\n    if (VLE_DATA[i].x >= x_in) {\n      p1 = VLE_DATA[i - 1];\n      p2 = VLE_DATA[i];\n      break;\n    }\n  }\n\n  const slope = (p2.y - p1.y) / (p2.x - p1.x);\n  const y_out = p1.y + (x_in - p1.x) * slope;\n\n  return y_out;\n}\n","/**\r\n * ui.js\r\n */\r\n\r\nimport { initializeVLEData, METHANOL_VLE_DATA } from './eq_line.js';\r\n\r\nconst LOCAL_STORAGE_DB_KEY = 'vle_systems_data';\r\n\r\nlet currentSystemProps = {\r\n  LK_Cp: 81.6,      // Methanol Liquid Cp\r\n  LK_Latent: 35270, // Methanol Latent Heat\r\n  HK_Cp: 75.3,      // Water Liquid Cp\r\n  HK_Latent: 40660  // Water Latent Heat\r\n};\r\n\r\n// --- Helper Functions for LocalStorage DB ---\r\nfunction getLocalSystems() {\r\n  const data = localStorage.getItem(LOCAL_STORAGE_DB_KEY);\r\n  return data ? JSON.parse(data) : [];\r\n}\r\n\r\nfunction saveLocalSystems(systems) {\r\n  localStorage.setItem(LOCAL_STORAGE_DB_KEY, JSON.stringify(systems));\r\n}\r\n\r\nexport class Variable {\r\n  xd;\r\n  xb;\r\n  zf;\r\n  q;\r\n  r_factor;\r\n  nm;\r\n  sc;\r\n  alpha;\r\n  Cp_LK;\r\n  Latent_LK;\r\n  Cp_HK;\r\n  Latent_HK;\r\n  constructor() {\r\n    //@ts-ignore\r\n    this.xd = parseFloat(document.getElementById('xd').value);\r\n    //@ts-ignore\r\n    this.xb = parseFloat(document.getElementById('xb').value);\r\n    //@ts-ignore\r\n    this.zf = parseFloat(document.getElementById('zf').value);\r\n    //@ts-ignore\r\n    this.q = parseFloat(document.getElementById('q').value);\r\n    //@ts-ignore\r\n    this.r_factor = parseFloat(document.getElementById('r_factor').value);\r\n    //@ts-ignore\r\n    this.nm = parseFloat(document.getElementById('nm').value);\r\n    //@ts-ignore\r\n    this.sc = parseFloat(document.getElementById('sub_cooling').value);\r\n    const systemSelect = document.getElementById('system_select');\r\n    // @ts-ignore\r\n    const isIdealMode = systemSelect && systemSelect.value === 'ideal_binary';\r\n\r\n    if (isIdealMode) {\r\n      // @ts-ignore\r\n      this.alpha = parseFloat(document.getElementById('alpha_value').value);\r\n    } else {\r\n      this.alpha = null;\r\n    }this.Cp_LK = currentSystemProps.LK_Cp || 0;\r\n    this.Latent_LK = currentSystemProps.LK_Latent || 0;\r\n    this.Cp_HK = currentSystemProps.HK_Cp || 0;\r\n    this.Latent_HK = currentSystemProps.HK_Latent || 0;\r\n\r\n    this.validate();\r\n  }\r\n\r\n  validate() {\r\n    const allValues = [\r\n      this.xd,\r\n      this.xb,\r\n      this.zf,\r\n      this.q,\r\n      this.r_factor,\r\n      this.nm,\r\n      this.sc,\r\n      this.alpha,\r\n    ];\r\n    if (allValues.some((val) => isNaN(val))) {\r\n      alert('There are invalid inputs. Please confirm type of inputs.');\r\n      return false;\r\n    }\r\n    if (this.alpha !== null) {\r\n      if (isNaN(this.alpha) || this.alpha <= 1.0) {\r\n        alert('α should be bigger than 1.0');\r\n        return false;\r\n      }\r\n    }\r\n    if (this.xd <= this.zf || this.zf <= this.xb) {\r\n      console.warn('warn: Invalid order of composition (xd > zf > xb).');\r\n    }\r\n    return true;\r\n  }\r\n}\r\n\r\n// --- DOM Elements ---\r\nconst systemSelect = document.getElementById('system_select');\r\nconst systemDeleteSelect = document.getElementById('system_for_delete_select');\r\nconst deleteVleBtn = document.getElementById('delete-vle-btn');\r\nconst systemDescription = document.querySelector('.description');\r\n\r\nconst vleInputModal = document.getElementById('vle-input-modal');\r\nconst addVleRowBtn = document.getElementById('add-vle-row-btn');\r\nconst vleDataList = document.getElementById('vle-data-list');\r\nconst saveVleBtn = document.getElementById('save-vle-btn');\r\nconst cancelVleBtn = document.getElementById('cancel-vle-btn');\r\nconst dataManagementModal = document.getElementById('data-management-modal');\r\nconst manageDataBtn = document.getElementById('manage-vle-data-btn');\r\nconst closeManageBtn = document.getElementById(\r\n  'close-data-management-modal-btn'\r\n);\r\nconst addNewVleDataBtn = document.getElementById('add-new-vle-data-btn');\r\nconst alphaContainer = document.getElementById('alpha-container');\r\n\r\nlet customVLEData = [];\r\n\r\n// --- Initialization ---\r\nexport function setUpUIListeners() {\r\n  fetchAndPopulateSystems();\r\n  if (systemSelect) {\r\n    systemSelect.addEventListener('change', handleSystemChange);\r\n  }\r\n  if (manageDataBtn) {\r\n    manageDataBtn.addEventListener('click', () => {\r\n      fetchAndPopulateSystems();\r\n      dataManagementModal.classList.remove('hidden');\r\n    });\r\n  }\r\n  if (closeManageBtn) {\r\n    closeManageBtn.addEventListener('click', () =>\r\n      dataManagementModal.classList.add('hidden')\r\n    );\r\n  }\r\n  // 4. 새 데이터 추가 버튼\r\n  if (addNewVleDataBtn) {\r\n    addNewVleDataBtn.addEventListener('click', () => {\r\n      dataManagementModal.classList.add('hidden');\r\n      showVLEModal();\r\n    });\r\n  }\r\n\r\n  // 5. 삭제 버튼\r\n  if (deleteVleBtn) {\r\n    deleteVleBtn.addEventListener('click', handleDeleteSystem);\r\n  }\r\n\r\n  setUpVLEModalManagement();\r\n  setUpDynamicVLEInput();\r\n}\r\n\r\n// --- Data Fetching & UI Population (LocalStorage) ---\r\n\r\nfunction fetchAndPopulateSystems() {\r\n  const systems = getLocalSystems();\r\n\r\n  // 1. 메인 선택 드롭다운\r\n  if (systemSelect) {\r\n    //@ts-ignore\r\n    const currentVal = systemSelect.value;\r\n    systemSelect.innerHTML = '';\r\n\r\n    const idealOpt = document.createElement('option');\r\n    idealOpt.value = 'ideal_binary';\r\n    idealOpt.textContent = 'Ideal Binary System (Relative Volatility α)';\r\n    systemSelect.appendChild(idealOpt);\r\n\r\n    // 기본값\r\n    const defaultOpt = document.createElement('option');\r\n    defaultOpt.value = 'methanol_water';\r\n    defaultOpt.textContent = 'Methanol-Water (Default)';\r\n    systemSelect.appendChild(defaultOpt);\r\n\r\n    // 로컬 데이터 추가\r\n    systems.forEach((sys) => {\r\n      const opt = document.createElement('option');\r\n      opt.value = sys.system_id;\r\n      opt.textContent = sys.system_name;\r\n      systemSelect.appendChild(opt);\r\n    });\r\n\r\n    // 선택값 유지\r\n    if (\r\n      currentVal &&\r\n      (currentVal === 'methanol_water' ||\r\n        systems.find((s) => s.system_id === currentVal))\r\n    ) {\r\n      //@ts-ignore\r\n      systemSelect.value = currentVal;\r\n    }\r\n  }\r\n\r\n  // 2. 삭제용 드롭다운\r\n  updateDeleteDropdown(systems);\r\n}\r\n\r\nfunction updateDeleteDropdown(localSystems) {\r\n  if (!systemDeleteSelect) return;\r\n\r\n  systemDeleteSelect.innerHTML = '';\r\n\r\n  if (localSystems.length === 0) {\r\n    const opt = document.createElement('option');\r\n    opt.textContent = '저장된 데이터가 없습니다.';\r\n    opt.disabled = true;\r\n    systemDeleteSelect.appendChild(opt);\r\n    //@ts-ignore\r\n    if (deleteVleBtn) deleteVleBtn.disabled = true;\r\n  } else {\r\n    //@ts-ignore\r\n    if (deleteVleBtn) deleteVleBtn.disabled = false;\r\n    localSystems.forEach((sys) => {\r\n      const opt = document.createElement('option');\r\n      opt.value = sys.system_id;\r\n      opt.textContent = sys.system_name;\r\n      systemDeleteSelect.appendChild(opt);\r\n    });\r\n  }\r\n}\r\n\r\n// --- System Selection & Loading ---\r\n\r\nasync function handleSystemChange(event) {\r\n  const selectedValue = event.target.value;\r\n  \r\n  // 1. Ideal Binary 선택 시\r\n  if (selectedValue === 'ideal_binary') {\r\n    if (alphaContainer) alphaContainer.classList.remove('hidden');\r\n    if (systemDescription) {\r\n      systemDescription.innerHTML = `<b>System:</b> Ideal Binary<br><b>Method:</b> Relative Volatility (α)`;\r\n    }\r\n    // Ideal의 경우 물성치가 애매하므로 0으로 초기화하거나 기본값 유지\r\n    currentSystemProps = { LK_Cp: 0, LK_Latent: 0, HK_Cp: 0, HK_Latent: 0 };\r\n    return;\r\n  }\r\n  \r\n  if (alphaContainer) alphaContainer.classList.add('hidden');\r\n\r\n  // 2. 기본값(Methanol-Water) 선택 시\r\n  if (selectedValue === 'methanol_water') {\r\n    initializeVLEData(METHANOL_VLE_DATA);\r\n    customVLEData = METHANOL_VLE_DATA;\r\n    \r\n    // [중요] 기본값 물성치 세팅\r\n    currentSystemProps = {\r\n      LK_Cp: 81.6,      // J/mol·K\r\n      LK_Latent: 35270, // J/mol\r\n      HK_Cp: 75.3,      // J/mol·K\r\n      HK_Latent: 40660  // J/mol\r\n    };\r\n\r\n    if (systemDescription)\r\n      systemDescription.innerHTML = `<b>System:</b> Methanol-Water<br><b>Assumptions:</b> Total Condenser, Partial Reboiler`;\r\n  } \r\n  // 3. 사용자 정의 데이터 선택 시\r\n  else {\r\n    loadSystemFromLocal(selectedValue);\r\n  }\r\n}\r\n\r\nfunction loadSystemFromLocal(systemId) {\r\n  try {\r\n    const systems = getLocalSystems();\r\n    const system = systems.find(s => s.system_id === systemId);\r\n\r\n    if (!system) throw new Error('Data not found');\r\n\r\n    initializeVLEData(system.vle_points);\r\n    customVLEData = system.vle_points;\r\n\r\n    // [중요] 로드된 시스템의 물성치로 전역 변수 업데이트\r\n    const p = system.props || {};\r\n    currentSystemProps = {\r\n      LK_Cp: p.LK_Cp || 0,\r\n      LK_Latent: p.LK_Latent || 0,\r\n      HK_Cp: p.HK_Cp || 0,\r\n      HK_Latent: p.HK_Latent || 0\r\n    };\r\n\r\n    // UI 설명창 업데이트\r\n    const propsInfo = `\r\n      <div style=\"font-size: 0.85em; color: #555; margin-top: 6px; line-height: 1.4;\">\r\n        <strong>[Light Key]</strong> Cp: ${currentSystemProps.LK_Cp}, λ: ${currentSystemProps.LK_Latent}<br>\r\n        <strong>[Heavy Key]</strong> Cp: ${currentSystemProps.HK_Cp}, λ: ${currentSystemProps.HK_Latent}\r\n      </div>\r\n    `;\r\n\r\n    if (systemDescription) {\r\n      systemDescription.innerHTML = `\r\n        <b>System:</b> ${system.system_name}<br>\r\n        <b>Source:</b> ${system.vle_source}\r\n        ${(currentSystemProps.LK_Cp || currentSystemProps.HK_Cp) ? propsInfo : ''}\r\n      `;\r\n    }\r\n  } catch (e) {\r\n    console.error(e);\r\n    alert('데이터를 불러오는데 실패했습니다. 기본값으로 돌아갑니다.');\r\n    //@ts-ignore\r\n    if (systemSelect) systemSelect.value = 'methanol_water';\r\n    handleSystemChange({ target: { value: 'methanol_water' } });\r\n  }\r\n}\r\n\r\n// --- VLE Data Saving (LocalStorage) ---\r\n\r\nfunction handleVLEDataSave() {\r\n  const rows = vleDataList.querySelectorAll('.vle-row');\r\n  const data = [];\r\n  rows.forEach((row) => {\r\n    //@ts-ignore\r\n    data.push({\r\n      //@ts-ignore\r\n      x: parseFloat(row.querySelector('.vle-x').value),\r\n      //@ts-ignore\r\n      y: parseFloat(row.querySelector('.vle-y').value),\r\n    });\r\n  });\r\n\r\n  if (!validateVLEData(data)) return;\r\n  data.sort((a, b) => a.x - b.x);\r\n\r\n  //@ts-ignore\r\n  const compA = document.getElementById('comp_name_A').value.trim();\r\n  //@ts-ignore\r\n  const compB = document.getElementById('comp_name_B').value.trim();\r\n  //@ts-ignore\r\n  const source = document.getElementById('vle_source_input').value.trim();\r\n  \r\n  // [수정됨] 자네가 준 HTML ID에 맞춰서 값 가져오기\r\n  //@ts-ignore\r\n  const lkCpInput = document.getElementById('LK_vle_Cpl_input').value;\r\n  //@ts-ignore\r\n  const lkLatInput = document.getElementById('LK_vle_vLatent_heat_input').value;\r\n  //@ts-ignore\r\n  const hkCpInput = document.getElementById('HK_vle_Cpl_input').value;\r\n  //@ts-ignore\r\n  const hkLatInput = document.getElementById('HK_vle_vLatent_heat_input').value;\r\n\r\n  // 숫자로 변환 (입력 없으면 0 처리)\r\n  const lkCp = lkCpInput ? parseFloat(lkCpInput) : 0;\r\n  const lkLat = lkLatInput ? parseFloat(lkLatInput) : 0;\r\n  const hkCp = hkCpInput ? parseFloat(hkCpInput) : 0;\r\n  const hkLat = hkLatInput ? parseFloat(hkLatInput) : 0;\r\n\r\n  const systemName = `${compA}-${compB}`;\r\n  const newSystemId = 'loc_' + Date.now() + Math.floor(Math.random() * 1000);\r\n\r\n  // 저장할 데이터 객체 구성\r\n  const newSystemPayload = {\r\n    system_id: newSystemId,\r\n    system_name: systemName,\r\n    component_a: compA,\r\n    component_b: compB,\r\n    vle_points: data,\r\n    vle_source: source,\r\n    // [중요] 물성치(Props) 객체 저장\r\n    props: {\r\n        LK_Cp: lkCp,\r\n        LK_Latent: lkLat,\r\n        HK_Cp: hkCp,\r\n        HK_Latent: hkLat\r\n    },\r\n    created_at: new Date().toISOString()\r\n  };\r\n\r\n  try {\r\n    const systems = getLocalSystems();\r\n    systems.push(newSystemPayload);\r\n    saveLocalSystems(systems);\r\n\r\n    // 후처리\r\n    customVLEData = data;\r\n    initializeVLEData(customVLEData); // 추후 initializeVLEData(customVLEData, newSystemPayload.props)로 변경 권장\r\n    hideVLEModal();\r\n    alert(`Success! '${systemName}' is saved.`);\r\n\r\n    fetchAndPopulateSystems();\r\n    if (systemSelect) {\r\n      //@ts-ignore\r\n      systemSelect.value = newSystemId;\r\n      // 강제로 이벤트 핸들러 호출하여 UI 업데이트\r\n      handleSystemChange({ target: { value: newSystemId } });\r\n    }\r\n  } catch (error) {\r\n    console.error(error);\r\n    alert('There are error during saving: ' + error.message);\r\n  }\r\n}\r\n\r\n// --- VLE Data Deleting (LocalStorage) ---\r\n\r\nfunction handleDeleteSystem() {\r\n  const deleteSelect = document.getElementById('system_for_delete_select');\r\n  const mainSystemSelect = document.getElementById('system_select');\r\n\r\n  //@ts-ignore\r\n  if (!deleteSelect || !deleteSelect.value) {\r\n    alert('System is not selected.');\r\n    return;\r\n  }\r\n  //@ts-ignore\r\n  const idToDelete = deleteSelect.value;\r\n  //@ts-ignore\r\n  const selectedOptionText = deleteSelect.options[deleteSelect.selectedIndex].text;\r\n\r\n  const isConfirmed = confirm(\r\n    `[warn] '${selectedOptionText}' will be deleted forever?`\r\n  );\r\n\r\n  if (!isConfirmed) return;\r\n\r\n  try {\r\n    const systems = getLocalSystems();\r\n    const newSystems = systems.filter(sys => sys.system_id !== idToDelete);\r\n    saveLocalSystems(newSystems);\r\n\r\n    alert('Deleted.');\r\n    fetchAndPopulateSystems();\r\n\r\n    //@ts-ignore\r\n    if (mainSystemSelect && mainSystemSelect.value === idToDelete) {\r\n      alert('삭제된 데이터를 보고 있어 기본값으로 전환됩니다.');\r\n      //@ts-ignore\r\n      mainSystemSelect.value = 'methanol_water';\r\n      initializeVLEData(METHANOL_VLE_DATA);\r\n      if(alphaContainer) alphaContainer.classList.add('hidden');\r\n      const desc = document.querySelector('.description');\r\n      if (desc) desc.innerHTML = `<b>System:</b> Methanol-Water<br><b>Assumptions:</b> Total Condenser, Partial Reboiler`;\r\n    }\r\n  } catch (error) {\r\n    console.error('Delete Error:', error);\r\n    alert(`오류 발생: ${error.message}`);\r\n  }\r\n}\r\n\r\n// --- Validation & Modal Helper ---\r\n\r\nfunction validateVLEData(data) {\r\n  //@ts-ignore\r\n  const compA = document.getElementById('comp_name_A').value;\r\n  //@ts-ignore\r\n  const compB = document.getElementById('comp_name_B').value;\r\n  //@ts-ignore\r\n  const src = document.getElementById('vle_source_input').value;\r\n\r\n  if (!compA || !compB || !src) {\r\n    alert('Name of componet and resources are necessary.');\r\n    return false;\r\n  }\r\n\r\n  // [수정됨] 물성치 숫자 유효성 검사\r\n  const propIds = ['LK_vle_Cpl_input', 'LK_vle_vLatent_heat_input', 'HK_vle_Cpl_input', 'HK_vle_vLatent_heat_input'];\r\n  for (const id of propIds) {\r\n      //@ts-ignore\r\n      const val = document.getElementById(id).value;\r\n      if (val && isNaN(parseFloat(val))) {\r\n          alert('Cp, Latent Heat should be number.');\r\n          return false;\r\n      }\r\n  }\r\n\r\n  if (data.length < 2) {\r\n      alert('Two VLE is necessary.');\r\n      return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction showVLEModal() {\r\n  if (vleInputModal) {\r\n    vleInputModal.classList.remove('hidden');\r\n    clearVLERows();\r\n    \r\n    // [수정됨] 입력 필드 초기화 (LK/HK 물성치 포함)\r\n    const inputsToClear = [\r\n        'comp_name_A', 'comp_name_B', 'vle_source_input',\r\n        'LK_vle_Cpl_input', 'LK_vle_vLatent_heat_input',\r\n        'HK_vle_Cpl_input', 'HK_vle_vLatent_heat_input'\r\n    ];\r\n    inputsToClear.forEach(id => {\r\n        //@ts-ignore\r\n        const el = document.getElementById(id);\r\n        //@ts-ignore\r\n        if(el) el.value = '';\r\n    });\r\n  }\r\n}\r\n\r\nfunction hideVLEModal() {\r\n  if (vleInputModal) vleInputModal.classList.add('hidden');\r\n  if (dataManagementModal) dataManagementModal.classList.remove('hidden');\r\n}\r\n\r\nfunction setUpVLEModalManagement() {\r\n  if (cancelVleBtn) cancelVleBtn.addEventListener('click', hideVLEModal);\r\n  if (saveVleBtn) saveVleBtn.addEventListener('click', handleVLEDataSave);\r\n}\r\n\r\nfunction setUpDynamicVLEInput() {\r\n  if (addVleRowBtn)\r\n    addVleRowBtn.addEventListener('click', () => addVLEDataRow());\r\n  if (vleDataList) {\r\n    vleDataList.addEventListener('click', (e) => {\r\n      //@ts-ignore\r\n      if (e.target.classList.contains('remove-vle-row')) {\r\n        //@ts-ignore\r\n        e.target.closest('.vle-row').remove();\r\n        updateRemoveButtonVisibility();\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction addVLEDataRow(x = 0.5, y = 0.5) {\r\n  if (!vleDataList) return;\r\n  const row = document.createElement('div');\r\n  row.className = 'vle-row';\r\n  row.innerHTML = `\r\n        <label>x:</label><input type=\"number\" step=\"any\" min=\"0\" max=\"1\" value=\"${x}\" class=\"vle-x\" required>\r\n        <label>y:</label><input type=\"number\" step=\"any\" min=\"0\" max=\"1\" value=\"${y}\" class=\"vle-y\" required>\r\n        <button type=\"button\" class=\"remove-vle-row\">-</button>\r\n    `;\r\n  const rows = vleDataList.querySelectorAll('.vle-row');\r\n  const lastRow = rows.length > 0 ? rows[rows.length - 1] : null;\r\n  if (lastRow) vleDataList.insertBefore(row, lastRow);\r\n  else vleDataList.appendChild(row);\r\n  updateRemoveButtonVisibility();\r\n}\r\n\r\nfunction clearVLERows() {\r\n  if (!vleDataList) return;\r\n  vleDataList.innerHTML = '';\r\n  // 0,0 및 1,1 고정값\r\n  const firstRow = document.createElement('div');\r\n  firstRow.className = 'vle-row';\r\n  firstRow.innerHTML = `<label>x:</label><input type=\"number\" value=\"0.0\" class=\"vle-x\" readonly><label>y:</label><input type=\"number\" value=\"0.0\" class=\"vle-y\" readonly><button class=\"remove-vle-row\" style=\"visibility:hidden\">-</button>`;\r\n  vleDataList.appendChild(firstRow);\r\n  const lastRow = document.createElement('div');\r\n  lastRow.className = 'vle-row';\r\n  lastRow.innerHTML = `<label>x:</label><input type=\"number\" value=\"1.0\" class=\"vle-x\" readonly><label>y:</label><input type=\"number\" value=\"1.0\" class=\"vle-y\" readonly><button class=\"remove-vle-row\" style=\"visibility:hidden\">-</button>`;\r\n  vleDataList.appendChild(lastRow);\r\n  updateRemoveButtonVisibility();\r\n}\r\n\r\nfunction updateRemoveButtonVisibility() {\r\n  if (!vleDataList) return;\r\n  const rows = Array.from(vleDataList.querySelectorAll('.vle-row'));\r\n  rows.forEach((row, index) => {\r\n    const btn = row.querySelector('.remove-vle-row');\r\n    if (btn) {\r\n      //@ts-ignore\r\n      btn.style.visibility =\r\n        index === 0 || index === rows.length - 1 ? 'hidden' : 'visible';\r\n    }\r\n  });\r\n}\r\n\r\nexport function getCustomVLEData() {\r\n  return customVLEData;\r\n}\r\n\r\n// Initial Call\r\nsetUpUIListeners();","/**\n * mccabe-thiele.js\n * Main logic for McCabe-Thiele\n * Use equilibrium line from 'eq_line.js'\n * Murphree efficiency is calculated between actual equilibrium line and operating line\n * (y_effective = y_op + nm * (y_ideal - y_op))\n * Seperated operating line into rectifying section and stripping section.\n */\n\nimport { getIdealEquilibriumY } from './eq_line.js';\nimport { Variable } from './ui.js';\n\n/**\n * VLE 곡선과 y=x 선(45도선)의 교차점 (공비점)을 모두 찾아 반환합니다.\n * @returns {number[]} - 공비점 x-조성 배열. 공비점이 없으면 빈 배열을 반환합니다.\n */\nfunction findAzeotropeX() {\n  const f = (x, alpha) => getIdealEquilibriumY(x, alpha) - x;\n  const azeotropes = [];\n\n  // [설정] 스캔할 간격의 수 (정밀도와 성능의 타협점, 1000개로 설정)\n  const NUM_SEGMENTS = 1000;\n  const step = 1.0 / NUM_SEGMENTS;\n  const tolerance = 1e-6; // 부동 소수점 오차 허용 범위\n\n  let x1 = 0.0;\n  let y1 = f(x1); // f(0) = 0.0 (항상 0임)\n\n  for (let i = 1; i <= NUM_SEGMENTS; i++) {\n    let x2 = Math.min(1.0, i * step); // 1.0을 넘지 않도록 보장\n    let y2 = f(x2);\n\n    // 1. [경계값 검사] (x=0 또는 x=1)에서는 공비점이 없다고 가정하고 넘어감\n    if (Math.abs(x1) < tolerance || Math.abs(x2 - 1.0) < tolerance) {\n      x1 = x2;\n      y1 = y2;\n      continue;\n    }\n\n    // 2. [부호 변화 검사] y1과 y2의 부호가 다른지 확인 (45도선 통과)\n    if (y1 * y2 < 0) {\n      // 부호가 바뀌었으므로, 이 구간 [x1, x2] 안에 공비점이 존재\n\n      // [이분법 재활용] 이 구간에서 정밀한 교차점을 찾음 (30회)\n      let low = x1;\n      let high = x2;\n      for (let j = 0; j < 30; j++) {\n        let mid_x = (low + high) / 2;\n        if (f(mid_x) === 0 || high - low < tolerance) {\n          low = mid_x; // mid_x로 수렴\n          break;\n        }\n        if (f(mid_x) * f(low) < 0) {\n          high = mid_x;\n        } else {\n          low = mid_x;\n        }\n      }\n      const x_azeo = (low + high) / 2;\n\n      // 중복 방지 및 배열에 추가\n      if (\n        azeotropes.length === 0 ||\n        Math.abs(azeotropes[azeotropes.length - 1] - x_azeo) > tolerance\n      ) {\n        azeotropes.push(x_azeo);\n      }\n    }\n\n    // 3. 다음 루프를 위해 값 갱신\n    x1 = x2;\n    y1 = y2;\n  }\n\n  return azeotropes; // 공비점 배열 반환\n}\n\n/**\n * Return x' when q = 0 (수평선)\n * (q-line 플로팅 및 R_min 계산에 사용됨)\n */\nfunction ideal_eq2(y_target, alpha) {\n  let low = 0.0;\n  let high = 1.0;\n  let mid_xa;\n  for (let i = 0; i < 30; i++) {\n    mid_xa = (low + high) / 2;\n    const y_guess = getIdealEquilibriumY(mid_xa, alpha);\n    if (y_guess < y_target) {\n      low = mid_xa;\n    } else {\n      high = mid_xa;\n    }\n  }\n  return (low + high) / 2;\n}\n\n/**\n * q-line actual equilibrium line의 교차점을 찾기 (q-line 플로팅 및 R_min 계산용).\n */\nfunction find_q_ideal_eq_intersect(q, zf, alpha) {\n  if (Math.abs(q - 1.0) < 1e-6) {\n    // q = 1 (수직선)\n    const x_intersect = zf;\n    const y_intersect = getIdealEquilibriumY(zf, alpha);\n    return { x: x_intersect, y: y_intersect };\n  }\n  if (Math.abs(q) < 1e-6) {\n    // q = 0 (수평선)\n    const x_intersect = ideal_eq2(zf, alpha);\n    const y_intersect = zf;\n    return { x: x_intersect, y: y_intersect };\n  }\n\n  const q_slope = q / (q - 1);\n  const q_intercept = -zf / (q - 1);\n  const q_line = (x) => q_slope * x + q_intercept;\n  const f = (x) => getIdealEquilibriumY(x, alpha) - q_line(x);\n\n  let low = 0.0,\n    high = 1.0,\n    mid_x;\n  for (let i = 0; i < 30; i++) {\n    mid_x = (low + high) / 2;\n    if (f(mid_x) < 0) {\n      low = mid_x;\n    } else {\n      high = mid_x;\n    }\n  }\n  const x_intersect = (low + high) / 2;\n  const y_intersect = getIdealEquilibriumY(x_intersect, alpha);\n\n  return { x: x_intersect, y: y_intersect };\n}\n\n/**\n * @param {array} dataArray\n * @param {number} y_target\n * @returns {number}\n */\nfunction find_x_from_data(dataArray, y_target) {\n  // Is target end of data?\n  if (y_target <= dataArray[0].y) return dataArray[0].x;\n  if (y_target >= dataArray[dataArray.length - 1].y)\n    return dataArray[dataArray.length - 1].x;\n\n  let low = 0;\n  let high = dataArray.length - 1;\n  let p1 = dataArray[low];\n  let p2 = dataArray[high];\n\n  while (high - low > 1) {\n    let mid = Math.floor((low + high) / 2);\n    if (dataArray[mid].y < y_target) {\n      low = mid;\n    } else {\n      high = mid;\n    }\n  }\n  p1 = dataArray[low];\n  p2 = dataArray[high];\n\n  // 데이터 사이를 선형으로 메꿈\n  const slope_inv = (p2.x - p1.x) / (p2.y - p1.y);\n  const x_out = p1.x + (y_target - p1.y) * slope_inv;\n\n  return x_out;\n}\n\n/**\n * McCabe-Thiele 계산을 수행하는 메인 함수\n * @param {Variable} variables - ui.js에서 생성된 Variable class\n * @returns {object}\n */\nexport function calculateMcCabeThiele(variables) {\n  const { xd, xb, zf, q, r_factor, nm, sc, Cp_LK, Latent_LK, Cp_HK, Latent_HK } = variables;\n  const plotData = {\n    ideal_eq_curve: [],\n    line_45: [\n      { x: 0, y: 0 },\n      { x: 1, y: 1 },\n    ],\n    q_line: [],\n    esol_line: [],\n    ssol_line: [],\n    steps: [],\n    effective_curve: [],\n  };\n  const results = { R_min: 0, R: 0, stages: 0, feed_stage: 0, xb_actual: 0 };\n  const { x: q_ideal_eq_x, y: q_ideal_eq_y } = find_q_ideal_eq_intersect(\n    q,\n    zf,\n    variables.alpha\n  );\n  const x_azeo_array = findAzeotropeX(); // 공비점 배열을 받음\n  let isAzeoError = false;\n  const azeoPointsInBoundary = [];\n\n  if (x_azeo_array.length > 0) {\n    // 1. 분리 영역(xb ~ xd)을 정의\n    const x_min = Math.min(xd, xb);\n    const x_max = Math.max(xd, xb);\n\n    // 2. 공비점이 분리 영역 내부에 있는지 확인\n    x_azeo_array.forEach((x_azeo) => {\n      if (x_azeo > x_min && x_azeo < x_max) {\n        isAzeoError = true;\n        azeoPointsInBoundary.push(x_azeo);\n      }\n    });\n    /** \n      const highest_x_azeo = x_azeo_array[x_azeo_array.length - 1];\n      if (xd > highest_x_azeo) {\n          isAzeoError = true;\n          if (!azeoPointsInBoundary.includes(highest_x_azeo)) {\n              azeoPointsInBoundary.push(highest_x_azeo);\n          }\n      }\n      */\n  }\n\n  // [신규] 공비물 오류 발생 시 즉시 반환 (계산 중단)\n  if (isAzeoError) {\n    // 오류가 발생했음을 알리는 플래그와 공비점 배열 반환\n    return {\n      plotData: {\n        /* empty */\n      },\n      results: {\n        /* empty */\n      },\n      floatStageNum: 0,\n      isAzeoError: true,\n      x_azeo_list: azeoPointsInBoundary.map((x) => x.toFixed(3)).join(', '),\n    };\n  }\n\n  const r_min_slope = (xd - q_ideal_eq_y) / (xd - q_ideal_eq_x);\n  results.R_min = r_min_slope / (1 - r_min_slope); // 최소 환류비\n\n  results.R = results.R_min * r_factor; // 실제 환류비\n\n  let R_internal = results.R;\n\n  const CP_LIQUID = xd*Cp_LK+(1-xd)*Cp_HK; // 메탄올 액체 열용량 (J/mol·K)\n  const LATENT_HEAT = xd*Latent_LK+(1-xd)*Latent_HK; // 메탄올 기화 잠열 (J/mol)\n  const DELTA_T = sc; // 과냉각\n\n  // 과냉각 보정 계수 (F > 1)\n  // 차가운 환류가 증기를 추가 응축시켜 내부 유량을 증가시킴\n  const F_factor = 1 + (CP_LIQUID * DELTA_T) / LATENT_HEAT; // 엔탈피 수지식을 토대로 구함\n\n  // 조작선 그리기용 '내부 환류비' 갱신\n  R_internal = results.R * F_factor;\n\n  const esol_slope = R_internal / (R_internal + 1); // 정류부 operating line 기울기\n  const esol_intercept = xd / (R_internal + 1); // 정류부 operating line 절편\n\n  let q_esol_intersect_x, q_esol_intersect_y;\n  if (Math.abs(q - 1.0) < 1e-6) {\n    q_esol_intersect_x = zf;\n    q_esol_intersect_y = esol_slope * q_esol_intersect_x + esol_intercept;\n  } else {\n    const q_slope = q / (q - 1);\n    const q_intercept = -zf / (q - 1);\n    q_esol_intersect_x =\n      (esol_intercept - q_intercept) / (q_slope - esol_slope);\n    q_esol_intersect_y = esol_slope * q_esol_intersect_x + esol_intercept;\n  }\n\n  const ssol_slope = (q_esol_intersect_y - xb) / (q_esol_intersect_x - xb); // 탈거부 operating line 기울기\n  const ssol_intercept = xb - ssol_slope * xb; // 탈거부 operating line 절편\n\n  plotData.q_line = [\n    { x: zf, y: zf },\n    { x: q_ideal_eq_x, y: q_ideal_eq_y },\n  ];\n  plotData.esol_line = [\n    { x: xd, y: xd },\n    { x: q_esol_intersect_x, y: q_esol_intersect_y },\n  ];\n  plotData.ssol_line = [\n    { x: xb, y: xb },\n    { x: q_esol_intersect_x, y: q_esol_intersect_y },\n  ];\n\n  const y_op_rect = (x) => esol_slope * x + esol_intercept;\n  const y_op_strip = (x) => ssol_slope * x + ssol_intercept;\n\n  for (let i = 0; i <= 100; i++) {\n    const x = i / 100.0;\n    const y_ideal = getIdealEquilibriumY(x, variables.alpha); // Ideal equilibrium(blue)\n\n    plotData.ideal_eq_curve.push({ x: x, y: y_ideal });\n\n    const y_op_r = y_op_rect(x);\n    const y_eff_r = y_op_r + nm * (y_ideal - y_op_r);\n    if (x > q_esol_intersect_x) {\n      plotData.effective_curve.push({ x: x, y: y_eff_r }); // 만약 qline을 안지났다면 rectifying operating line 기준으로, 아니면 stripping으로\n    }\n\n    const y_op_s = y_op_strip(x);\n    const y_eff_s = y_op_s + nm * (y_ideal - y_op_s);\n    if (x <= q_esol_intersect_x) {\n      plotData.effective_curve.push({ x: x, y: y_eff_s });\n    }\n  }\n\n  // stepping, 단수 계산.\n\n  let current_x = xd;\n  let current_y = xd;\n  let stage_count = 0;\n  let floatStageNum = 0;\n  const MAX_STAGES = 200;\n\n  while (current_x > xb && stage_count < MAX_STAGES) {\n    stage_count++;\n\n    let next_x; // 이번 스텝의 '다음 x'\n    const step_start_y = current_y; // 수평선 그리기를 위한 y값 저장\n\n    // 수평 이동\n    next_x = find_x_from_data(plotData.effective_curve, current_y);\n\n    // 수직 이동\n    let next_y;\n    if (next_x > q_esol_intersect_x) {\n      next_y = y_op_rect(next_x);\n    } else {\n      next_y = y_op_strip(next_x);\n\n      if (results.feed_stage === 0) {\n        results.feed_stage = stage_count;\n      }\n    }\n\n    plotData.steps.push([\n      { x: current_x, y: step_start_y },\n      { x: next_x, y: step_start_y },\n    ]); // 수평선\n    plotData.steps.push([\n      { x: next_x, y: step_start_y },\n      { x: next_x, y: next_y },\n    ]); // 수직선\n\n    if (next_x < xb) {\n      floatStageNum = stage_count + (current_x - xb) / (current_x - next_x);\n      break;\n    }\n\n    current_x = next_x;\n    current_y = next_y;\n  }\n\n  if (results.feed_stage === 0) results.feed_stage = 1;\n  results.stages = stage_count;\n  results.xb_actual = current_x;\n\n  return { plotData, results, floatStageNum, isAzeoError, x_azeo_array };\n}\n","/**\n * main.js\n * - Receive event from'index.html'.\n * - Get class 'Variable' from 'ui.js'.\n * - Actual calculation from 'mccabe-thiele.js'.\n * - Draw graph by Chart.js at canvas(html)\n */\n\nimport { Variable } from './ui.js';\nimport { calculateMcCabeThiele } from './mccabe-thiele.js';\nimport {\n  Chart,\n  LinearScale, // 선형 눈금 (linear scale)\n  PointElement, // 점 요소\n  LineElement, // 선 요소\n  LineController, // 선 그래프 컨트롤러\n  Filler, // 영역 채우기 플러그인\n  Tooltip, // 툴팁\n  Legend, // 범례\n  Title, // 제목\n  ScatterController, // 산점도 차트 컨트롤러\n} from 'chart.js';\nimport '../style.css';\nlet mccabeChart = null;\n\nconst calcForm = document.getElementById('calc-form');\nconst chartCanvas = document.getElementById('mccabeThieleChart');\nconst resultsTextElement = document.getElementById('results-text');\n//@ts-ignore\nconst ctx = chartCanvas.getContext('2d');\n\nChart.register(\n  LinearScale,\n  PointElement,\n  LineElement,\n  LineController, // 선 그래프 컨트롤러\n  Filler, // 영역 채우기 플러그인\n  Tooltip,\n  Legend,\n  Title,\n  ScatterController\n);\n\n/**\n * Run calculation and update states\n */\nfunction runCalculation() {\n  try {\n    const variables = new Variable();\n    const { plotData, results, floatStageNum, isAzeoError, x_azeo_array } =\n      calculateMcCabeThiele(variables);\n\n    if (isAzeoError) {\n      const errorMessage = `Azeotrope Error: Desired distillate composition (xd = ${variables.xd.toFixed(\n        3\n      )}) exceeds the azeotropic point (x_azeo = ${x_azeo_array}). Separation to this purity is physically impossible.`;\n      alert(errorMessage);\n      resultsTextElement.textContent = `Calculation Error:\\n${errorMessage}`;\n\n      if (mccabeChart) {\n        mccabeChart.destroy();\n      }\n\n      return;\n    }\n    renderResults(results, floatStageNum); // print output as text\n    renderPlot(plotData); // print output as plot\n  } catch (error) {\n    console.error('McCabe-Thiele 계산 중 오류 발생:', error);\n    alert(\n      `계산에 실패했습니다: ${error.message}\\n콘솔(F12)에서 자세한 내용을 확인하세요.`\n    );\n    resultsTextElement.textContent = `계산 오류:\\n${error.message}`;\n  }\n}\n\n/**\n * print output at HTML <pre> tag\n * @param {object} results\n */\nfunction renderResults(results, floatStageNum) {\n  document.getElementById('results_Rmin').textContent =\n    results.R_min.toFixed(3);\n  document.getElementById('results_Rreal').textContent = results.R.toFixed(3);\n  //@ts-ignore\n  document.getElementById('results_Rfactor').textContent =\n    //@ts-ignore\n    document.getElementById('r_factor').value;\n  document.getElementById('results_Nstage').textContent = results.stages;\n  document.getElementById('results_Nstage_float').textContent =\n    floatStageNum.toFixed(1);\n  document.getElementById('results_Fstage').textContent = results.feed_stage;\n}\n\n/**\n * 계산된 플롯 데이터를 받아 Chart.js로 캔버스에 그래프를 그립니다.\n * (v2.0 - 분리된 유사 평형 곡선 렌더링)\n * @param {object} plotData - mccabe-thiele.js가 반환한 plotData 객체\n */\nfunction renderPlot(plotData) {\n  // 1. Chart.js가 요구하는 'datasets' 형식으로 데이터를 변환합니다.\n  const datasets = [\n    // (1) 이상 평형 곡선 (VLE 데이터)\n    {\n      label: 'Ideal Equilibrium (VLE)',\n      data: plotData.ideal_eq_curve, // [{x, y}, ...]\n      borderColor: 'blue',\n      borderWidth: 2,\n      pointRadius: 0,\n      showLine: true,\n      type: 'line',\n    },\n\n    // [!] 'murphree_eq_curve'\n    {\n      label: 'Effective Eq. (Rectifying)',\n      data: plotData.effective_curve,\n      borderColor: '#00c000', // 녹색\n      borderDash: [5, 5], // 점선\n      borderWidth: 2,\n      pointRadius: 0,\n      showLine: true,\n      type: 'line',\n    },\n\n    // (3) y=x (45도선)\n    {\n      label: 'y = x',\n      data: plotData.line_45,\n      borderColor: 'grey',\n      borderWidth: 1,\n      pointRadius: 0,\n      showLine: true,\n      type: 'line',\n    },\n    // (4) q-line\n    {\n      label: 'q-Line',\n      data: plotData.q_line,\n      borderColor: 'orange', // (q-line 색상, 겹칠 수 있으니 orange 유지)\n      borderWidth: 2,\n      pointRadius: 0,\n      showLine: true,\n      type: 'line',\n    },\n    // (5) 정류부 조작선 (ESOL)\n    {\n      label: 'ESOL',\n      data: plotData.esol_line,\n      borderColor: '#6a5acd', // 보라색\n      borderWidth: 2,\n      pointRadius: 0,\n      showLine: true,\n      type: 'line',\n    },\n    // (6) 탈거부 조작선 (SSOL)\n    {\n      label: 'SSOL',\n      data: plotData.ssol_line,\n      borderColor: '#6a5acd', // 보라색\n      borderWidth: 2,\n      pointRadius: 0,\n      showLine: true,\n      type: 'line',\n    },\n    // (7) 계단 (Steps) - 각 선분을 별도의 데이터셋으로 추가\n    ...plotData.steps.map((segment) => ({\n      type: 'line',\n      data: segment, // [{x,y}, {x,y}]\n      borderColor: '#FF6384', // 빨간색 (계단)\n      borderWidth: 1.5,\n      pointRadius: 0,\n      fill: false,\n      showLine: true,\n      showInLegend: false,\n    })),\n  ];\n\n  // 2. 기존에 차트가 있다면, 업데이트를 위해 파괴(destroy)합니다.\n  if (mccabeChart) {\n    mccabeChart.destroy();\n  }\n\n  // 3. 새 차트를 생성합니다.\n  mccabeChart = new Chart(ctx, {\n    type: 'scatter',\n    data: { datasets: datasets },\n    options: {\n      plugins: {\n        title: {\n          display: true,\n          text: 'McCabe-Thiele Plot (Methanol-Water @ 1 atm)',\n          font: { size: 18 },\n        },\n        legend: {\n          position: 'bottom',\n          labels: {\n            // [!] 우리가 이전에 수정한 'TypeError' 방지 코드 포함\n            filter: (legendItem) => {\n              if (!legendItem.text) {\n                return false; // 'label'이 없는 항목 (예: steps) 숨기기\n              }\n              return true; // 'label'이 있는 항목만 표시\n            },\n          },\n        },\n        tooltip: {\n          callbacks: {\n            label: (context) => {\n              const d = context.raw;\n              //@ts-ignore\n              return `${context.dataset.label}: (x: ${d.x.toFixed(\n                3\n                //@ts-ignore\n              )}, y: ${d.y.toFixed(3)})`;\n            },\n          },\n        },\n      },\n      scales: {\n        x: {\n          type: 'linear',\n          position: 'bottom',\n          title: { display: true, text: 'Liquid Mole Fraction (x)' },\n          min: 0.0,\n          max: 1.0,\n        },\n        y: {\n          type: 'linear',\n          title: { display: true, text: 'Vapor Mole Fraction (y)' },\n          min: 0.0,\n          max: 1.0,\n        },\n      },\n      aspectRatio: 1,\n      animation: false,\n      parsing: false,\n    },\n  });\n}\n\ncalcForm.addEventListener('submit', (event) => {\n  event.preventDefault();\n  runCalculation();\n});\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  console.log('페이지 로드 완료. 기본값으로 첫 계산을 실행합니다.');\n  runCalculation();\n});\n"],"names":["VLE_DATA","METHANOL_VLE_DATA","x","y","initializeVLEData","newVLEData","Array","isArray","length","console","error","log","getIdealEquilibriumY","x_in","alpha","p1","p2","i","slope","LOCAL_STORAGE_DB_KEY","currentSystemProps","LK_Cp","LK_Latent","HK_Cp","HK_Latent","getLocalSystems","data","localStorage","getItem","JSON","parse","saveLocalSystems","systems","setItem","stringify","Variable","xd","xb","zf","q","r_factor","nm","sc","Cp_LK","Latent_LK","Cp_HK","Latent_HK","constructor","this","parseFloat","document","getElementById","value","systemSelect","isIdealMode","validate","some","val","isNaN","alert","warn","systemDeleteSelect","deleteVleBtn","systemDescription","querySelector","vleInputModal","addVleRowBtn","vleDataList","saveVleBtn","cancelVleBtn","dataManagementModal","manageDataBtn","closeManageBtn","addNewVleDataBtn","alphaContainer","customVLEData","fetchAndPopulateSystems","currentVal","innerHTML","idealOpt","createElement","textContent","appendChild","defaultOpt","forEach","sys","opt","system_id","system_name","find","s","localSystems","disabled","updateDeleteDropdown","async","handleSystemChange","event","selectedValue","target","classList","remove","add","systemId","system","Error","vle_points","p","props","propsInfo","vle_source","e","loadSystemFromLocal","hideVLEModal","updateRemoveButtonVisibility","rows","from","querySelectorAll","row","index","btn","style","visibility","find_x_from_data","dataArray","y_target","low","high","mid","Math","floor","slope_inv","calculateMcCabeThiele","variables","plotData","ideal_eq_curve","line_45","q_line","esol_line","ssol_line","steps","effective_curve","results","R_min","R","stages","feed_stage","xb_actual","q_ideal_eq_x","q_ideal_eq_y","abs","x_intersect","mid_xa","ideal_eq2","q_slope","q_intercept","f","mid_x","find_q_ideal_eq_intersect","x_azeo_array","azeotropes","tolerance","x1","y1","x2","min","y2","j","x_azeo","push","findAzeotropeX","isAzeoError","azeoPointsInBoundary","x_min","x_max","max","floatStageNum","x_azeo_list","map","toFixed","join","r_min_slope","R_internal","F_factor","esol_slope","esol_intercept","q_esol_intersect_x","q_esol_intersect_y","ssol_slope","ssol_intercept","y_op_rect","y_op_strip","y_ideal","y_op_r","y_eff_r","y_op_s","y_eff_s","current_x","current_y","stage_count","next_x","step_start_y","next_y","addEventListener","firstRow","className","lastRow","clearVLERows","id","el","deleteSelect","mainSystemSelect","idToDelete","selectedOptionText","options","selectedIndex","text","confirm","filter","desc","message","compA","compB","src","propIds","validateVLEData","sort","a","b","trim","source","lkCpInput","lkLatInput","hkCpInput","hkLatInput","lkCp","lkLat","hkCp","hkLat","systemName","newSystemId","Date","now","random","newSystemPayload","component_a","component_b","created_at","toISOString","insertBefore","addVLEDataRow","contains","closest","mccabeChart","calcForm","chartCanvas","resultsTextElement","ctx","getContext","runCalculation","errorMessage","destroy","renderResults","datasets","label","borderColor","borderWidth","pointRadius","showLine","type","borderDash","segment","fill","showInLegend","plugins","title","display","font","size","legend","position","labels","legendItem","tooltip","callbacks","context","d","raw","dataset","scales","aspectRatio","animation","parsing","renderPlot","register","preventDefault"],"ignoreList":[],"sourceRoot":""}