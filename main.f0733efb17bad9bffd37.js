"use strict";(self.webpackChunkmccabe_thiele_method_online=self.webpackChunkmccabe_thiele_method_online||[]).push([[792],{374:(e,t,n)=>{class l{xd;xb;zf;q;r_factor;nm;sc;constructor(){this.xd=parseFloat(document.getElementById("xd").value),this.xb=parseFloat(document.getElementById("xb").value),this.zf=parseFloat(document.getElementById("zf").value),this.q=parseFloat(document.getElementById("q").value),this.r_factor=parseFloat(document.getElementById("r_factor").value),this.nm=parseFloat(document.getElementById("nm").value),this.sc=parseFloat(document.getElementById("sub_cooling").value),this.validate()}validate(){return[this.xd,this.xb,this.zf,this.q,this.r_factor,this.nm,this.sc].some(e=>isNaN(e))?(console.error("입력값 오류: 일부 값이 숫자가 아닙니다 (NaN).",this),alert("유효하지 않은 입력값이 있습니다. 숫자만 입력해주세요."),!1):((this.xd<=this.zf||this.zf<=this.xb)&&console.warn(`입력값 경고: 조성 순서가 올바르지 않습니다 (xd > zf > xb 여야 함). xd=${this.xd}, zf=${this.zf}, xb=${this.xb}`),!0)}}const o=document.getElementById("system_select"),s=document.getElementById("system-description"),a=document.getElementById("vle-input-modal"),i=document.getElementById("add-vle-row-btn"),r=document.getElementById("vle-data-list"),d=document.getElementById("save-vle-btn"),c=document.getElementById("cancel-vle-btn");let u=null;function y(){a&&a.classList.add("hidden")}function m(){if(!r)return;const e=Array.from(r.querySelectorAll(".vle-row")),t=e.length;e.forEach((e,n)=>{const l=e.querySelector(".remove-vle-row");if(l){const e=n>0&&n<t-1;l.style.visibility=e?"visible":"hidden"}})}o.addEventListener("click",e=>{const t=e.target.value;"methanol_water"===t?s.innerHTML="<b>System:</b> Methanol-Water @ 1 atm (VLE 데이터 기반)":"user_input"===t&&a&&(a.classList.remove("hidden"),function(){r.innerHTML="";const e=document.createElement("div");e.className="vle-row",e.innerHTML='\n        <label>x (Liquid):</label>\n        <input type="number" step="any" min="0" max="1" value="0.0" class="vle-x" required>\n        <label>y (Vapor):</label>\n        <input type="number" step="any" min="0" max="1" value="0.0" class="vle-y" required>\n        <button type="button" class="remove-vle-row" style="visibility: hidden;">-</button>\n    ',r.appendChild(e);const t=document.createElement("div");t.className="vle-row",t.innerHTML='\n        <label>x (Liquid):</label>\n        <input type="number" step="any" min="0" max="1" value="1.0" class="vle-x" required>\n        <label>y (Vapor):</label>\n        <input type="number" step="any" min="0" max="1" value="1.0" class="vle-y" required>\n        <button type="button" class="remove-vle-row" style="visibility: hidden;">-</button>\n    ',r.appendChild(t),m()}())}),c&&c.addEventListener("click",()=>{y(),o&&(o.value="methanol_water")}),d&&d.addEventListener("click",function(){if(!r)return;const e=[],t=r.querySelectorAll(".vle-row");for(const n of t){const t=n.querySelector(".vle-x"),l=n.querySelector(".vle-y"),o=parseFloat(t.value),s=parseFloat(l.value);if(isNaN(o)||isNaN(s)||o<0||o>1||s<0||s>1)return alert("경고: x 또는 y 값이 0과 1 사이의 유효한 조성이 아닙니다."),void t.focus();if(o>s&&0!==o&&1!==s)return alert(`경고: VLE 데이터 (x=${o}, y=${s})는 x > y 조건을 만족하지 않습니다. VLE 데이터가 유효한지 확인하십시오.`),void t.focus();e.push({x:o,y:s})}u=e,y(),alert(`성공: 총 ${e.length}개의 Custom VLE 데이터가 저장되어 계산에 사용됩니다.`);const n=document.getElementById("comp_name_A"),l=document.getElementById("comp_name_B"),o=n&&l?`${n.value}-${l.value}`:"Custom System";s&&(s.innerHTML=`<b>System:</b> ${o} (Custom VLE) <br><b>Assumptions:</b> Total Condenser, Partial Reboiler`)}),i&&i.addEventListener("click",()=>{!function(e=.5,t=.5){if(!r)return;const n=document.createElement("div");n.className="vle-row",n.innerHTML=`\n        <label>x (Liquid):</label>\n        <input type="number" step="any" min="0" max="1" value="${e}" class="vle-x" required>\n        <label>y (Vapor):</label>\n        <input type="number" step="any" min="0" max="1" value="${t}" class="vle-y" required>\n        <button type="button" class="remove-vle-row">-</button>\n    `;const l=r.querySelectorAll(".vle-row"),o=l.length>0?l[l.length-1]:null;o?r.insertBefore(n,o):r.appendChild(n),m()}()}),r&&r.addEventListener("click",e=>{e.target.classList.contains("remove-vle-row")&&(e.target.closest(".vle-row").remove(),m())});const x=[{x:0,y:0},{x:.012,y:.068},{x:.02,y:.121},{x:.026,y:.159},{x:.033,y:.188},{x:.036,y:.215},{x:.053,y:.275},{x:.076,y:.366},{x:.1,y:.438},{x:.12,y:.485},{x:.14,y:.522},{x:.15,y:.541},{x:.2,y:.605},{x:.3,y:.686},{x:.4,y:.739},{x:.5,y:.779},{x:.6,y:.825},{x:.7,y:.87},{x:.8,y:.915},{x:.9,y:.958},{x:.95,y:.979},{x:1,y:1}];function b(e){if(e<=0)return 0;if(e>=1)return 1;let t=x[0],n=x[1];for(let l=1;l<x.length;l++)if(x[l].x>=e){t=x[l-1],n=x[l];break}const l=(n.y-t.y)/(n.x-t.x);return t.y+(e-t.x)*l}function p(e,t){if(t<=e[0].y)return e[0].x;if(t>=e[e.length-1].y)return e[e.length-1].x;let n=0,l=e.length-1,o=e[n],s=e[l];for(;l-n>1;){let o=Math.floor((n+l)/2);e[o].y<t?n=o:l=o}o=e[n],s=e[l];const a=(s.x-o.x)/(s.y-o.y);return o.x+(t-o.y)*a}var f=n(106);let v=null;const h=document.getElementById("calc-form"),g=document.getElementById("mccabeThieleChart"),_=document.getElementById("results-text"),E=g.getContext("2d");function L(){try{const e=new l,{plotData:t,results:n,floatStageNum:o}=function(e){const{xd:t,xb:n,zf:l,q:o,r_factor:s,nm:a,sc:i}=e,r={ideal_eq_curve:[],line_45:[{x:0,y:0},{x:1,y:1}],q_line:[],esol_line:[],ssol_line:[],steps:[],effective_curve:[]},d={R_min:0,R:0,stages:0,feed_stage:0,xb_actual:0},{x:c,y:u}=function(e,t){if(Math.abs(e-1)<1e-6)return{x:t,y:b(t)};if(Math.abs(e)<1e-6){const e=function(e){let t,n=0,l=1;for(let o=0;o<30;o++)t=(n+l)/2,b(t)<e?n=t:l=t;return(n+l)/2}(t);return{x:e,y:t}}const n=e/(e-1),l=-t/(e-1),o=e=>b(e)-(e=>n*e+l)(e);let s,a=0,i=1;for(let e=0;e<30;e++)s=(a+i)/2,o(s)<0?a=s:i=s;const r=(a+i)/2;return{x:r,y:b(r)}}(o,l),y=(t-u)/(t-c);d.R_min=y/(1-y),d.R=d.R_min*s;let m=d.R;const x=1+81.6*i/35270;m=d.R*x;const f=m/(m+1),v=t/(m+1);let h,g;Math.abs(o-1)<1e-6?(h=l,g=f*h+v):(h=(v- -l/(o-1))/(o/(o-1)-f),g=f*h+v);const _=(g-n)/(h-n),E=n-_*n;r.q_line=[{x:l,y:l},{x:c,y:u}],r.esol_line=[{x:t,y:t},{x:h,y:g}],r.ssol_line=[{x:n,y:n},{x:h,y:g}];const L=e=>f*e+v,q=e=>_*e+E;for(let e=0;e<=100;e++){const t=e/100,n=b(t);r.ideal_eq_curve.push({x:t,y:n});const l=L(t),o=l+a*(n-l);t>h&&r.effective_curve.push({x:t,y:o});const s=q(t),i=s+a*(n-s);t<=h&&r.effective_curve.push({x:t,y:i})}let w=t,B=t,C=0,I=0;for(;w>n&&C<200;){let e;C++;const t=B;let l;if(e=p(r.effective_curve,B),e>h?l=L(e):(l=q(e),0===d.feed_stage&&(d.feed_stage=C)),r.steps.push([{x:w,y:t},{x:e,y:t}]),r.steps.push([{x:e,y:t},{x:e,y:l}]),e<n){I=C+(w-n)/(w-e);break}w=e,B=l}return 0===d.feed_stage&&(d.feed_stage=1),d.stages=C,d.xb_actual=w,{plotData:r,results:d,floatStageNum:I}}(e);!function(e,t){document.getElementById("results_Rmin").textContent=e.R_min.toFixed(3),document.getElementById("results_Rreal").textContent=e.R.toFixed(3),document.getElementById("results_Rfactor").textContent=document.getElementById("r_factor").value,document.getElementById("results_Nstage").textContent=e.stages,document.getElementById("results_Nstage_float").textContent=t.toFixed(1),document.getElementById("results_Fstage").textContent=e.feed_stage}(n,o),function(e){const t=[{label:"Ideal Equilibrium (VLE)",data:e.ideal_eq_curve,borderColor:"blue",borderWidth:2,pointRadius:0,showLine:!0,type:"line"},{label:"Effective Eq. (Rectifying)",data:e.effective_curve,borderColor:"#00c000",borderDash:[5,5],borderWidth:2,pointRadius:0,showLine:!0,type:"line"},{label:"y = x",data:e.line_45,borderColor:"grey",borderWidth:1,pointRadius:0,showLine:!0,type:"line"},{label:"q-Line",data:e.q_line,borderColor:"orange",borderWidth:2,pointRadius:0,showLine:!0,type:"line"},{label:"ESOL",data:e.esol_line,borderColor:"#6a5acd",borderWidth:2,pointRadius:0,showLine:!0,type:"line"},{label:"SSOL",data:e.ssol_line,borderColor:"#6a5acd",borderWidth:2,pointRadius:0,showLine:!0,type:"line"},...e.steps.map(e=>({type:"line",data:e,borderColor:"#FF6384",borderWidth:1.5,pointRadius:0,fill:!1,showLine:!0,showInLegend:!1}))];v&&v.destroy(),v=new f.t1(E,{type:"scatter",data:{datasets:t},options:{plugins:{title:{display:!0,text:"McCabe-Thiele Plot (Methanol-Water @ 1 atm)",font:{size:18}},legend:{position:"bottom",labels:{filter:e=>!!e.text}},tooltip:{callbacks:{label:e=>{const t=e.raw;return`${e.dataset.label}: (x: ${t.x.toFixed(3)}, y: ${t.y.toFixed(3)})`}}}},scales:{x:{type:"linear",position:"bottom",title:{display:!0,text:"Liquid Mole Fraction (x)"},min:0,max:1},y:{type:"linear",title:{display:!0,text:"Vapor Mole Fraction (y)"},min:0,max:1}},aspectRatio:1,animation:!1,parsing:!1}})}(t)}catch(e){console.error("McCabe-Thiele 계산 중 오류 발생:",e),alert(`계산에 실패했습니다: ${e.message}\n콘솔(F12)에서 자세한 내용을 확인하세요.`),_.textContent=`계산 오류:\n${e.message}`}}f.t1.register(f.kc,f.FN,f.No,f.ZT,f.dN,f.m_,f.s$,f.hE,f.Pz),h.addEventListener("submit",e=>{e.preventDefault(),L()}),document.addEventListener("DOMContentLoaded",()=>{console.log("페이지 로드 완료. 기본값으로 첫 계산을 실행합니다."),L()})}},e=>{e.O(0,[106],()=>e(e.s=374)),e.O()}]);
//# sourceMappingURL=main.f0733efb17bad9bffd37.js.map