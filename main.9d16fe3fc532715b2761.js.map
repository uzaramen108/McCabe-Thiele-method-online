{"version":3,"file":"main.9d16fe3fc532715b2761.js","mappings":"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","sources":["webpack://mccabe-thiele-method-online/./src/resources/js/ui.js","webpack://mccabe-thiele-method-online/./src/resources/js/eq_line.js","webpack://mccabe-thiele-method-online/./src/resources/js/mccabe-thiele.js","webpack://mccabe-thiele-method-online/./src/resources/js/main.js"],"sourcesContent":["/**\n * ui.js\n * Read input from index.html\n * Show output from mccabe-thiele.js to index.html\n */\n\nexport class Variable {\n  xd;\n  xb;\n  zf;\n  q;\n  r_factor;\n  nm;\n  sc;\n\n  constructor() {\n    // Used parseFloat() for shifting string(.value) to number\n    //@ts-ignore\n    this.xd = parseFloat(document.getElementById(\"xd\").value);\n    //@ts-ignore\n    this.xb = parseFloat(document.getElementById(\"xb\").value);\n    //@ts-ignore\n    this.zf = parseFloat(document.getElementById(\"zf\").value);\n    //@ts-ignore\n    this.q = parseFloat(document.getElementById(\"q\").value);\n    //@ts-ignore\n    this.r_factor = parseFloat(document.getElementById(\"r_factor\").value);\n    //@ts-ignore\n    this.nm = parseFloat(document.getElementById(\"nm\").value);\n    //@ts-ignore\n    this.sc = parseFloat(document.getElementById(\"sub_cooling\").value);\n    this.validate();\n  }\n\n  /**\n   * @returns {boolean} - 모든 값이 유효하면 true, 아니면 false\n   */\n  validate() {\n    const allValues = [\n      this.xd,\n      this.xb,\n      this.zf,\n      this.q,\n      this.r_factor,\n      this.nm,\n      this.sc,\n    ];\n    if (allValues.some((val) => isNaN(val))) {\n      console.error(\"입력값 오류: 일부 값이 숫자가 아닙니다 (NaN).\", this);\n      alert(\"유효하지 않은 입력값이 있습니다. 숫자만 입력해주세요.\");\n      return false;\n    }\n    if (this.xd <= this.zf || this.zf <= this.xb) {\n      console.warn(\n        `입력값 경고: 조성 순서가 올바르지 않습니다 (xd > zf > xb 여야 함). xd=${this.xd}, zf=${this.zf}, xb=${this.xb}`,\n      );\n    }\n    return true;\n  }\n}\n\n// [DOM 요소 캐싱]\n// Canvas에서 이미 선언된 요소들을 여기에 추가적으로 캐싱 (main.js에서도 사용됨)\nconst systemSelect = document.getElementById('system_select');\nconst systemDescription = document.getElementById('system-description');\nconst vleInputModal = document.getElementById('vle-input-modal');\nconst addVleRowBtn = document.getElementById('add-vle-row-btn');\nconst vleDataList = document.getElementById('vle-data-list');\nconst saveVleBtn = document.getElementById('save-vle-btn');\nconst cancelVleBtn = document.getElementById('cancel-vle-btn');\n\n// [전역 상태]\n// 사용자가 입력한 VLE 데이터를 임시로 저장할 배열 (나중에 DB나 LocalStorage로 옮겨야 함)\nlet customVLEData = []; \n\n\n/**\n * 페이지 로드 시 UI 이벤트를 설정합니다.\n */\nexport function setUpUIListeners() {\n    setUpSystemSelection();\n    setUpVLEModalManagement();\n    setUpDynamicVLEInput();\n\n    // 초기 계산 실행 (main.js에서 호출하므로 여기서는 생략 가능)\n    // document.getElementById('calc-form').addEventListener('submit', runCalculation);\n}\n\n\n// --- VLE 시스템 선택 및 모달 제어 로직 ---\n\n/**\n * System selection 드롭다운 리스너를 설정합니다.\n */\nfunction setUpSystemSelection() {\n    //if (!systemSelect || !vleInputModal) return;\n    systemSelect.addEventListener('click', (event) => {\n        // @ts-ignore\n        const selectedValue = event.target.value;\n        if (selectedValue === 'methanol_water') {\n            systemDescription.innerHTML = '<b>System:</b> Methanol-Water @ 1 atm (VLE 데이터 기반)';\n            // [TODO] VLE 데이터 상태를 Default로 리셋하는 로직 추가\n        } else if (selectedValue === 'user_input') {\n            // \"Add Custom VLE Data...\"를 선택하면 모달을 띄웁니다.\n            showVLEModal();\n        }\n    });\n}\n\n/**\n * VLE 데이터 입력 모달의 버튼 리스너를 설정합니다.\n */\nfunction setUpVLEModalManagement() {\n    if (cancelVleBtn) {\n        cancelVleBtn.addEventListener('click', () => {\n            hideVLEModal();\n            // 취소 시 드롭다운을 Default로 되돌립니다.\n            //@ts-ignore\n            if (systemSelect) systemSelect.value = 'methanol_water'; \n        });\n    }\n    if (saveVleBtn) {\n        saveVleBtn.addEventListener('click', handleVLEDataSave);\n    }\n}\n\n/**\n * VLE 입력 모달을 표시합니다.\n */\nfunction showVLEModal() {\n    if (vleInputModal) {\n        vleInputModal.classList.remove('hidden');\n        // 모달을 열 때마다 초기 입력 행을 유지하고 나머지 데이터는 비우는 것이 좋음\n        clearVLERows(true); \n    }\n}\n\n/**\n * VLE 입력 모달을 숨깁니다.\n */\nfunction hideVLEModal() {\n    if (vleInputModal) {\n        vleInputModal.classList.add('hidden');\n    }\n}\n\n\n// --- 동적 VLE 데이터 행 관리 로직 ---\n\n/**\n * VLE 데이터 입력 행의 추가/제거 리스너를 설정합니다.\n */\nfunction setUpDynamicVLEInput() {\n    if (addVleRowBtn) {\n        addVleRowBtn.addEventListener('click', () => {\n            addVLEDataRow();\n        });\n    }\n    // 부모 요소에 리스너를 달아 동적으로 생성된 '제거' 버튼을 처리 (이벤트 위임)\n    if (vleDataList) {\n        vleDataList.addEventListener('click', (event) => {\n            // @ts-ignore\n            if (event.target.classList.contains('remove-vle-row')) {\n                // @ts-ignore\n                event.target.closest('.vle-row').remove();\n                updateRemoveButtonVisibility();\n            }\n        });\n    }\n}\n\n/**\n * 새로운 VLE 데이터 입력 행을 동적으로 추가합니다.\n */\nfunction addVLEDataRow(x = 0.5, y = 0.5) {\n    // if (!vleDataList) return;\n    const row = document.createElement('div');\n    row.className = 'vle-row';\n    \n    row.innerHTML = `\n        <label>x (Liquid):</label>\n        <input type=\"number\" step=\"any\" min=\"0\" max=\"1\" value=\"${x}\" class=\"vle-x\" required>\n        <label>y (Vapor):</label>\n        <input type=\"number\" step=\"any\" min=\"0\" max=\"1\" value=\"${y}\" class=\"vle-y\" required>\n        <button type=\"button\" class=\"remove-vle-row\">-</button>\n    `;\n    vleDataList.appendChild(row);\n    updateRemoveButtonVisibility();\n}\n\n/**\n * VLE 데이터 행들을 모두 비우거나, 초기 1개만 남깁니다.\n * @param {boolean} keepFirstRow - 첫 번째 행을 남길지 여부\n */\nfunction clearVLERows(keepFirstRow) {\n    let rows = vleDataList.querySelectorAll('.vle-row');\n    if (rows.length === 0) {\n        addVLEDataRow(0.0, 0.0);\n        addVLEDataRow(1.0, 1.0);\n        rows = vleDataList.querySelectorAll('.vle-row');\n    }\n\n    if (keepFirstRow) {\n        // 첫 행을 제외하고 모두 삭제\n        for (let i = 1; i < rows.length-1; i++) {\n            rows[i].remove();\n        }\n        // 첫 행의 값은 0.0으로 초기화\n        const firstRow = rows[0];\n        const lastRow = rows[-1];\n        // @ts-ignore\n        firstRow.querySelector('.vle-x').value = '0.0';\n        // @ts-ignore\n        firstRow.querySelector('.vle-y').value = '0.0';\n        // @ts-ignore\n        lastRow.querySelector('.vle-x').value = '1.0';\n        // @ts-ignore\n        flastRow.querySelector('.vle-y').value = '1.0';\n    } else {\n        // 모든 행 삭제\n        vleDataList.innerHTML = '';\n        addVLEDataRow(0.0, 0.0); // keep default component\n        addVLEDataRow(1.0, 1.0);\n    }\n    updateRemoveButtonVisibility();\n}\n\n/**\n * VLE 데이터 행이 1개일 때만 제거 버튼을 숨깁니다.\n */\nfunction updateRemoveButtonVisibility() {\n    if (!vleDataList) return;\n    const rows = Array.from(vleDataList.querySelectorAll('.vle-row')); \n    const totalRows = rows.length;\n\n    rows.forEach((row, index) => { // [수정] 인덱스를 활용\n        const removeBtn = row.querySelector('.remove-vle-row');\n        if (removeBtn) {\n            // [핵심 로직] 첫 행(index === 0)과 마지막 행(index === totalRows - 1)이 아니면 visible\n            const isMiddleRow = index > 0 && index < totalRows - 1;\n            // @ts-ignore\n            removeBtn.style.visibility = isMiddleRow ? 'visible' : 'hidden';\n        }\n    });\n}\n\n\n// --- VLE 데이터 저장 및 유효성 검사 ---\n\n/**\n * 'Save & Use VLE Data' 버튼 클릭 시 호출됩니다.\n */\nfunction handleVLEDataSave() {\n    if (!vleDataList) return;\n\n    const data = [];\n    const rows = vleDataList.querySelectorAll('.vle-row');\n    \n    // 1. 데이터 추출 및 유효성 검사\n    for (const row of rows) {\n        // @ts-ignore\n        const xInput = row.querySelector('.vle-x');\n        // @ts-ignore\n        const yInput = row.querySelector('.vle-y');\n        //@ts-ignore\n        const x = parseFloat(xInput.value);\n        //@ts-ignore\n        const y = parseFloat(yInput.value);\n\n        if (isNaN(x) || isNaN(y) || x < 0 || x > 1 || y < 0 || y > 1) {\n            alert(\"경고: x 또는 y 값이 0과 1 사이의 유효한 조성이 아닙니다.\");\n            //@ts-ignore\n            xInput.focus();\n            return;\n        }\n        // McCabe-Thiele Plot의 기본 전제: x와 y는 0과 1 사이의 유효한 몰 분율.\n        if (x > y && x !== 0.0 && y !== 1.0) {\n            // 액체 조성이 증기 조성보다 높을 수 없음 (VLE 곡선이 45도선 위에 있어야 함)\n            alert(`경고: VLE 데이터 (x=${x}, y=${y})는 x > y 조건을 만족하지 않습니다. VLE 데이터가 유효한지 확인하십시오.`);\n            //@ts-ignore\n            xInput.focus();\n            return;\n        }\n\n        data.push({ x: x, y: y });\n    }\n    \n    // 2. [TODO] DB 또는 LocalStorage에 저장하는 로직\n    customVLEData = data;\n    \n    // 3. UI 업데이트\n    hideVLEModal();\n    alert(`성공: 총 ${data.length}개의 Custom VLE 데이터가 저장되어 계산에 사용됩니다.`);\n\n    // [TODO] VLE 시스템 설명을 사용자 정의 이름으로 업데이트\n    const compA = document.getElementById('comp_name_A');\n    const compB = document.getElementById('comp_name_B');\n    //@ts-ignore\n    const systemName = (compA && compB) ? `${compA.value}-${compB.value}` : 'Custom System';\n\n    if (systemDescription) {\n         systemDescription.innerHTML = `<b>System:</b> ${systemName} (Custom VLE) <br><b>Assumptions:</b> Total Condenser, Partial Reboiler`;\n    }\n}\n\n/**\n * [TODO] 나중에 main.js/mccabe-thiele.js가 이 함수를 호출하여 데이터를 가져갈 것입니다.\n * @returns {Array<{x: number, y: number}>}\n */\nexport function getCustomVLEData() {\n    return customVLEData;\n}\n\n// 초기화 호출 (main.js에서 이 모듈을 import할 때 실행됨)\nsetUpUIListeners();","// (메탄올-물 @ 1 atm)\nconst METHANOL_VLE_DATA = [\n  { x: 0.0, y: 0.0 },\n  { x: 0.012, y: 0.068 },\n  { x: 0.02, y: 0.121 },\n  { x: 0.026, y: 0.159 },\n  { x: 0.033, y: 0.188 },\n  { x: 0.036, y: 0.215 },\n  { x: 0.053, y: 0.275 },\n  { x: 0.076, y: 0.366 },\n  { x: 0.1, y: 0.438 },\n  { x: 0.12, y: 0.485 },\n  { x: 0.14, y: 0.522 },\n  { x: 0.15, y: 0.541 },\n  { x: 0.2, y: 0.605 },\n  { x: 0.3, y: 0.686 },\n  { x: 0.4, y: 0.739 },\n  { x: 0.5, y: 0.779 },\n  { x: 0.6, y: 0.825 },\n  { x: 0.7, y: 0.87 },\n  { x: 0.8, y: 0.915 },\n  { x: 0.9, y: 0.958 },\n  { x: 0.95, y: 0.979 },\n  { x: 1.0, y: 1.0 },\n];\n\n/**\n * @param {number} x_in - 액상 몰분율\n * @returns {number} - 기상 몰분율 (y), 빈 곳으로 선형 플롯\n */\nexport function getIdealEquilibriumY(x_in) {\n  if (x_in <= 0) return 0;\n  if (x_in >= 1) return 1;\n  let p1 = METHANOL_VLE_DATA[0];\n  let p2 = METHANOL_VLE_DATA[1];\n\n  for (let i = 1; i < METHANOL_VLE_DATA.length; i++) {\n    if (METHANOL_VLE_DATA[i].x >= x_in) {\n      p1 = METHANOL_VLE_DATA[i - 1];\n      p2 = METHANOL_VLE_DATA[i];\n      break;\n    }\n  }\n\n  const slope = (p2.y - p1.y) / (p2.x - p1.x);\n  const y_out = p1.y + (x_in - p1.x) * slope;\n\n  return y_out;\n}\n","/**\n * mccabe-thiele.js\n * Main logic for McCabe-Thiele\n * Use equilibrium line from 'eq_line.js'\n * Murphree efficiency is calculated between actual equilibrium line and operating line\n * (y_effective = y_op + nm * (y_ideal - y_op))\n * Seperated operating line into rectifying section and stripping section.\n */\n\nimport { getIdealEquilibriumY } from \"./eq_line.js\";\nimport { Variable } from \"./ui.js\";\n\n/**\n * Return x' when q = 0 (수평선)\n * (q-line 플로팅 및 R_min 계산에 사용됨)\n */\nfunction ideal_eq2(y_target) {\n  let low = 0.0;\n  let high = 1.0;\n  let mid_xa;\n  for (let i = 0; i < 30; i++) {\n    mid_xa = (low + high) / 2;\n    const y_guess = getIdealEquilibriumY(mid_xa);\n    if (y_guess < y_target) {\n      low = mid_xa;\n    } else {\n      high = mid_xa;\n    }\n  }\n  return (low + high) / 2;\n}\n\n/**\n * q-line actual equilibrium line의 교차점을 찾기 (q-line 플로팅 및 R_min 계산용).\n */\nfunction find_q_ideal_eq_intersect(q, zf) {\n  if (Math.abs(q - 1.0) < 1e-6) {\n    // q = 1 (수직선)\n    const x_intersect = zf;\n    const y_intersect = getIdealEquilibriumY(zf);\n    return { x: x_intersect, y: y_intersect };\n  }\n  if (Math.abs(q) < 1e-6) {\n    // q = 0 (수평선)\n    const x_intersect = ideal_eq2(zf);\n    const y_intersect = zf;\n    return { x: x_intersect, y: y_intersect };\n  }\n\n  const q_slope = q / (q - 1);\n  const q_intercept = -zf / (q - 1);\n  const q_line = (x) => q_slope * x + q_intercept;\n  const f = (x) => getIdealEquilibriumY(x) - q_line(x);\n\n  let low = 0.0,\n    high = 1.0,\n    mid_x;\n  for (let i = 0; i < 30; i++) {\n    mid_x = (low + high) / 2;\n    if (f(mid_x) < 0) {\n      low = mid_x;\n    } else {\n      high = mid_x;\n    }\n  }\n  const x_intersect = (low + high) / 2;\n  const y_intersect = getIdealEquilibriumY(x_intersect);\n\n  return { x: x_intersect, y: y_intersect };\n}\n\n/**\n * @param {array} dataArray\n * @param {number} y_target\n * @returns {number}\n */\nfunction find_x_from_data(dataArray, y_target) {\n  // Is target end of data?\n  if (y_target <= dataArray[0].y) return dataArray[0].x;\n  if (y_target >= dataArray[dataArray.length - 1].y)\n    return dataArray[dataArray.length - 1].x;\n\n  let low = 0;\n  let high = dataArray.length - 1;\n  let p1 = dataArray[low];\n  let p2 = dataArray[high];\n\n  while (high - low > 1) {\n    let mid = Math.floor((low + high) / 2);\n    if (dataArray[mid].y < y_target) {\n      low = mid;\n    } else {\n      high = mid;\n    }\n  }\n  p1 = dataArray[low];\n  p2 = dataArray[high];\n\n  // 데이터 사이를 선형으로 메꿈\n  const slope_inv = (p2.x - p1.x) / (p2.y - p1.y);\n  const x_out = p1.x + (y_target - p1.y) * slope_inv;\n\n  return x_out;\n}\n\n/**\n * McCabe-Thiele 계산을 수행하는 메인 함수\n * @param {Variable} variables - ui.js에서 생성된 Variable class\n * @returns {object}\n */\nexport function calculateMcCabeThiele(variables) {\n  const { xd, xb, zf, q, r_factor, nm, sc } = variables;\n  const plotData = {\n    ideal_eq_curve: [],\n    line_45: [\n      { x: 0, y: 0 },\n      { x: 1, y: 1 },\n    ],\n    q_line: [],\n    esol_line: [],\n    ssol_line: [],\n    steps: [],\n    effective_curve: [],\n  };\n  const results = { R_min: 0, R: 0, stages: 0, feed_stage: 0, xb_actual: 0 };\n  const { x: q_ideal_eq_x, y: q_ideal_eq_y } = find_q_ideal_eq_intersect(q, zf);\n\n  const r_min_slope = (xd - q_ideal_eq_y) / (xd - q_ideal_eq_x);\n  results.R_min = r_min_slope / (1 - r_min_slope); // 최소 환류비\n\n  results.R = results.R_min * r_factor; // 실제 환류비\n\n  let R_internal = results.R;\n\n  const CP_LIQUID = 81.6; // 메탄올 액체 열용량 (J/mol·K)\n  const LATENT_HEAT = 35270; // 메탄올 기화 잠열 (J/mol)\n  const DELTA_T = sc; // 과냉각\n\n  // 과냉각 보정 계수 (F > 1)\n  // 차가운 환류가 증기를 추가 응축시켜 내부 유량을 증가시킴\n  const F_factor = 1 + (CP_LIQUID * DELTA_T) / LATENT_HEAT; // 엔탈피 수지식을 토대로 구함\n\n  // 조작선 그리기용 '내부 환류비' 갱신\n  R_internal = results.R * F_factor;\n\n  const esol_slope = R_internal / (R_internal + 1); // 정류부 operating line 기울기\n  const esol_intercept = xd / (R_internal + 1); // 정류부 operating line 절편\n\n  let q_esol_intersect_x, q_esol_intersect_y;\n  if (Math.abs(q - 1.0) < 1e-6) {\n    q_esol_intersect_x = zf;\n    q_esol_intersect_y = esol_slope * q_esol_intersect_x + esol_intercept;\n  } else {\n    const q_slope = q / (q - 1);\n    const q_intercept = -zf / (q - 1);\n    q_esol_intersect_x =\n      (esol_intercept - q_intercept) / (q_slope - esol_slope);\n    q_esol_intersect_y = esol_slope * q_esol_intersect_x + esol_intercept;\n  }\n\n  const ssol_slope = (q_esol_intersect_y - xb) / (q_esol_intersect_x - xb); // 탈거부 operating line 기울기\n  const ssol_intercept = xb - ssol_slope * xb; // 탈거부 operating line 절편\n\n  plotData.q_line = [\n    { x: zf, y: zf },\n    { x: q_ideal_eq_x, y: q_ideal_eq_y },\n  ];\n  plotData.esol_line = [\n    { x: xd, y: xd },\n    { x: q_esol_intersect_x, y: q_esol_intersect_y },\n  ];\n  plotData.ssol_line = [\n    { x: xb, y: xb },\n    { x: q_esol_intersect_x, y: q_esol_intersect_y },\n  ];\n\n  const y_op_rect = (x) => esol_slope * x + esol_intercept;\n  const y_op_strip = (x) => ssol_slope * x + ssol_intercept;\n\n  for (let i = 0; i <= 100; i++) {\n    const x = i / 100.0;\n    const y_ideal = getIdealEquilibriumY(x); // Ideal equilibrium(blue)\n\n    plotData.ideal_eq_curve.push({ x: x, y: y_ideal });\n\n    const y_op_r = y_op_rect(x);\n    const y_eff_r = y_op_r + nm * (y_ideal - y_op_r);\n    if (x > q_esol_intersect_x) {\n      plotData.effective_curve.push({ x: x, y: y_eff_r }); // 만약 qline을 안지났다면 rectifying operating line 기준으로, 아니면 stripping으로\n    }\n\n    const y_op_s = y_op_strip(x);\n    const y_eff_s = y_op_s + nm * (y_ideal - y_op_s);\n    if (x <= q_esol_intersect_x) {\n      plotData.effective_curve.push({ x: x, y: y_eff_s });\n    }\n  }\n\n  // stepping, 단수 계산.\n\n  let current_x = xd;\n  let current_y = xd;\n  let stage_count = 0;\n  let floatStageNum = 0;\n  const MAX_STAGES = 200;\n\n  while (current_x > xb && stage_count < MAX_STAGES) {\n    stage_count++;\n\n    let next_x; // 이번 스텝의 '다음 x'\n    const step_start_y = current_y; // 수평선 그리기를 위한 y값 저장\n\n    // 수평 이동\n    next_x = find_x_from_data(plotData.effective_curve, current_y);\n\n    // 수직 이동\n    let next_y;\n    if (next_x > q_esol_intersect_x) {\n      next_y = y_op_rect(next_x);\n    } else {\n      next_y = y_op_strip(next_x);\n\n      if (results.feed_stage === 0) {\n        results.feed_stage = stage_count;\n      }\n    }\n\n    plotData.steps.push([\n      { x: current_x, y: step_start_y },\n      { x: next_x, y: step_start_y },\n    ]); // 수평선\n    plotData.steps.push([\n      { x: next_x, y: step_start_y },\n      { x: next_x, y: next_y },\n    ]); // 수직선\n\n    if (next_x < xb) {\n      floatStageNum = stage_count + (current_x - xb) / (current_x - next_x);\n      break;\n    }\n\n    current_x = next_x;\n    current_y = next_y;\n  }\n\n  if (results.feed_stage === 0) results.feed_stage = 1;\n  results.stages = stage_count;\n  results.xb_actual = current_x;\n\n  return { plotData, results, floatStageNum };\n}\n","/**\n * main.js\n * - Receive event from'index.html'.\n * - Get class 'Variable' from 'ui.js'.\n * - Actual calculation from 'mccabe-thiele.js'.\n * - Draw graph by Chart.js at canvas(html)\n */\n\nimport { Variable } from './ui.js';\nimport { calculateMcCabeThiele } from './mccabe-thiele.js';\nimport {\n    Chart,\n    LinearScale, // 선형 눈금 (linear scale)\n    PointElement, // 점 요소\n    LineElement,  // 선 요소\n    LineController,  // 선 그래프 컨트롤러\n    Filler,          // 영역 채우기 플러그인\n    Tooltip,      // 툴팁\n    Legend,       // 범례\n    Title,        // 제목\n    ScatterController, // 산점도 차트 컨트롤러\n} from 'chart.js'; \nimport \"../style.css\";\nlet mccabeChart = null;\n\nconst calcForm = document.getElementById('calc-form');\nconst chartCanvas = document.getElementById('mccabeThieleChart');\nconst resultsTextElement = document.getElementById('results-text');\n//@ts-ignore\nconst ctx = chartCanvas.getContext('2d');\n\nChart.register(\n    LinearScale,\n    PointElement,\n    LineElement,\n    LineController,  // 선 그래프 컨트롤러\n    Filler,          // 영역 채우기 플러그인\n    Tooltip,\n    Legend,\n    Title,\n    ScatterController\n);\n\n/**\n * Run calculation and update states\n */\nfunction runCalculation() {\n    try {\n        const variables = new Variable();\n        const { plotData, results, floatStageNum } = calculateMcCabeThiele(variables);\n        renderResults(results, floatStageNum); // print output as text\n        renderPlot(plotData); // print output as plot\n\n    } catch (error) {\n        console.error(\"McCabe-Thiele 계산 중 오류 발생:\", error);\n        alert(`계산에 실패했습니다: ${error.message}\\n콘솔(F12)에서 자세한 내용을 확인하세요.`);\n        resultsTextElement.textContent = `계산 오류:\\n${error.message}`;\n    }\n}\n\n/**\n * print output at HTML <pre> tag\n * @param {object} results\n */\nfunction renderResults(results, floatStageNum) {\n    document.getElementById('results_Rmin').textContent = results.R_min.toFixed(3);\n    document.getElementById('results_Rreal').textContent = results.R.toFixed(3);\n    //@ts-ignore\n    document.getElementById('results_Rfactor').textContent = document.getElementById('r_factor').value;\n    document.getElementById('results_Nstage').textContent = results.stages;\n    document.getElementById('results_Nstage_float').textContent = floatStageNum.toFixed(1);\n    document.getElementById('results_Fstage').textContent = results.feed_stage;\n}\n\n/**\n * [!] 수정된 함수 [!]\n * 계산된 플롯 데이터를 받아 Chart.js로 캔버스에 그래프를 그립니다.\n * (v2.0 - 분리된 유사 평형 곡선 렌더링)\n * @param {object} plotData - mccabe-thiele.js가 반환한 plotData 객체\n */\nfunction renderPlot(plotData) {\n    \n    // 1. Chart.js가 요구하는 'datasets' 형식으로 데이터를 변환합니다.\n    const datasets = [\n        // (1) 이상 평형 곡선 (VLE 데이터)\n        {\n            label: 'Ideal Equilibrium (VLE)',\n            data: plotData.ideal_eq_curve, // [{x, y}, ...]\n            borderColor: 'blue',\n            borderWidth: 2,\n            pointRadius: 0,\n            showLine: true,\n            type: 'line',\n        },\n        \n        \n        // [!] 'murphree_eq_curve'\n        {   label: 'Effective Eq. (Rectifying)',\n            data: plotData.effective_curve,\n            borderColor: '#00c000', // 녹색\n            borderDash: [5, 5], // 점선\n            borderWidth: 2,\n            pointRadius: 0,\n            showLine: true,\n            type: 'line',\n        },\n\n        // (3) y=x (45도선)\n        {\n            label: 'y = x',\n            data: plotData.line_45,\n            borderColor: 'grey',\n            borderWidth: 1,\n            pointRadius: 0,\n            showLine: true,\n            type: 'line',\n        },\n        // (4) q-line\n        {\n            label: 'q-Line',\n            data: plotData.q_line,\n            borderColor: 'orange', // (q-line 색상, 겹칠 수 있으니 orange 유지)\n            borderWidth: 2,\n            pointRadius: 0,\n            showLine: true,\n            type: 'line',\n        },\n        // (5) 정류부 조작선 (ESOL)\n        {\n            label: 'ESOL',\n            data: plotData.esol_line,\n            borderColor: '#6a5acd', // 보라색\n            borderWidth: 2,\n            pointRadius: 0,\n            showLine: true,\n            type: 'line',\n        },\n        // (6) 탈거부 조작선 (SSOL)\n        {\n            label: 'SSOL',\n            data: plotData.ssol_line,\n            borderColor: '#6a5acd', // 보라색\n            borderWidth: 2,\n            pointRadius: 0,\n            showLine: true,\n            type: 'line',\n        },\n        // (7) 계단 (Steps) - 각 선분을 별도의 데이터셋으로 추가\n        ...plotData.steps.map(segment => ({\n            type: 'line',\n            data: segment, // [{x,y}, {x,y}]\n            borderColor: '#FF6384', // 빨간색 (계단)\n            borderWidth: 1.5,\n            pointRadius: 0,\n            fill: false,\n            showLine: true,\n            showInLegend: false, \n        }))\n    ];\n\n    // 2. 기존에 차트가 있다면, 업데이트를 위해 파괴(destroy)합니다.\n    if (mccabeChart) {\n        mccabeChart.destroy();\n    }\n\n    // 3. 새 차트를 생성합니다.\n    mccabeChart = new Chart(ctx, {\n        type: 'scatter', \n        data: { datasets: datasets },\n        options: {\n            plugins: {\n                title: {\n                    display: true,\n                    text: 'McCabe-Thiele Plot (Methanol-Water @ 1 atm)',\n                    font: { size: 18 }\n                },\n                legend: {\n                    position: 'bottom',\n                    labels: {\n                        // [!] 우리가 이전에 수정한 'TypeError' 방지 코드 포함\n                        filter: (legendItem) => {\n                            if (!legendItem.text) {\n                                return false; // 'label'이 없는 항목 (예: steps) 숨기기\n                            }\n                            return true; // 'label'이 있는 항목만 표시\n                        }\n                    }\n                },\n                tooltip: {\n                    callbacks: {\n                        label: (context) => {\n                            const d = context.raw\n                            //@ts-ignore\n                            return `${context.dataset.label}: (x: ${d.x.toFixed(3)}, y: ${d.y.toFixed(3)})`;\n                        }\n                    }\n                }\n            },\n            scales: {\n                x: {\n                    type: 'linear',\n                    position: 'bottom',\n                    title: { display: true, text: 'Liquid Mole Fraction (x)' },\n                    min: 0.0,\n                    max: 1.0,\n                },\n                y: {\n                    type: 'linear',\n                    title: { display: true, text: 'Vapor Mole Fraction (y)' },\n                    min: 0.0,\n                    max: 1.0,\n                }\n            },\n            aspectRatio: 1,\n            animation: false,\n            parsing: false, \n        }\n    });\n}\n\ncalcForm.addEventListener('submit', (event) => {\n    event.preventDefault(); \n    runCalculation();\n});\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    console.log(\"페이지 로드 완료. 기본값으로 첫 계산을 실행합니다.\");\n    runCalculation();\n});"],"names":["Variable","xd","xb","zf","q","r_factor","nm","sc","constructor","this","parseFloat","document","getElementById","value","validate","some","val","isNaN","console","error","alert","warn","systemSelect","systemDescription","vleInputModal","addVleRowBtn","vleDataList","saveVleBtn","cancelVleBtn","customVLEData","hideVLEModal","classList","add","addVLEDataRow","x","y","row","createElement","className","innerHTML","appendChild","updateRemoveButtonVisibility","rows","Array","from","querySelectorAll","totalRows","length","forEach","index","removeBtn","querySelector","isMiddleRow","style","visibility","addEventListener","event","selectedValue","target","remove","i","firstRow","lastRow","flastRow","clearVLERows","data","xInput","yInput","focus","push","compA","compB","systemName","contains","closest","METHANOL_VLE_DATA","getIdealEquilibriumY","x_in","p1","p2","slope","find_x_from_data","dataArray","y_target","low","high","mid","Math","floor","slope_inv","mccabeChart","calcForm","chartCanvas","resultsTextElement","ctx","getContext","runCalculation","variables","plotData","results","floatStageNum","ideal_eq_curve","line_45","q_line","esol_line","ssol_line","steps","effective_curve","R_min","R","stages","feed_stage","xb_actual","q_ideal_eq_x","q_ideal_eq_y","abs","x_intersect","mid_xa","ideal_eq2","q_slope","q_intercept","f","mid_x","find_q_ideal_eq_intersect","r_min_slope","R_internal","F_factor","esol_slope","esol_intercept","q_esol_intersect_x","q_esol_intersect_y","ssol_slope","ssol_intercept","y_op_rect","y_op_strip","y_ideal","y_op_r","y_eff_r","y_op_s","y_eff_s","current_x","current_y","stage_count","next_x","step_start_y","next_y","calculateMcCabeThiele","textContent","toFixed","renderResults","datasets","label","borderColor","borderWidth","pointRadius","showLine","type","borderDash","map","segment","fill","showInLegend","destroy","options","plugins","title","display","text","font","size","legend","position","labels","filter","legendItem","tooltip","callbacks","context","d","raw","dataset","scales","min","max","aspectRatio","animation","parsing","renderPlot","message","register","preventDefault","log"],"ignoreList":[],"sourceRoot":""}